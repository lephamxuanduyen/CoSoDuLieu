CREATE DATABASE QL_THUENHA
ON
(NAME = 'QL_THUENHA',
FILENAME = 'F:\CSDL\SQL_CODE\QL_THUENHA.mdf',
SIZE = 10MB,
MAXSIZE = UNLIMITED,
FILEGROWTH = 5MB)
LOG ON
(NAME = 'QL_THUENHA_LOG',
FILENAME = 'F:\CSDL\SQL_CODE\QL_THUENHA_LOG.ldf',
SIZE = 5MB,
MAXSIZE = UNLIMITED,
FILEGROWTH = 2MB)

USE QL_THUENHA

CREATE TABLE LOAINHA
(MALN CHAR(3) CONSTRAINT PK_LOAINHA PRIMARY KEY,
TENLN VARCHAR(10),
GHICHU VARCHAR(100))
GO

CREATE TABLE NHA
(MANHA CHAR(5) CONSTRAINT PK_NHA PRIMARY KEY,
DIACHI NVARCHAR(100),
TIENTHUE INT,
MALN CHAR(3),
CONSTRAINT FK_NHA_LOAINHA FOREIGN KEY(MALN) REFERENCES LOAINHA(MALN))
GO

CREATE TABLE KHACHHANG
(MAKH CHAR(5) CONSTRAINT PK_KH PRIMARY KEY,
TENKH NVARCHAR(100),
DIACHI NVARCHAR(100),
DIENTHOAI CHAR(10),
KHANANGTHUE INT)
GO

CREATE TABLE DANGTIN
(MANHA CHAR(5),
NGDANG DATE,
THOIHAN INT,
CONSTRAINT PK_DANGTIN PRIMARY KEY(MANHA,NGDANG),
CONSTRAINT FK_DANGTIN FOREIGN KEY(MANHA) REFERENCES NHA(MANHA))
GO

CREATE TABLE XEMNHA
(MANHA CHAR(5) NOT NULL,
MAKH CHAR(5) NOT NULL,
NGXEMNHA DATE,
KETLUAN NVARCHAR(100),
CONSTRAINT PK_XEMNHA PRIMARY KEY(MANHA,MAKH),
CONSTRAINT FK_MANHA_XEMNHA FOREIGN KEY(MANHA) REFERENCES NHA(MANHA),
CONSTRAINT FK_MAKH_XEMNHA FOREIGN KEY(MAKH) REFERENCES KHACHHANG(MAKH))
GO

INSERT INTO LOAINHA(MALN,TENLN) VALUES
('NC1',N'Cấp 1'),
('NC2',N'Cấp 2'),
('NC3',N'Cấp 3'),
('NC4',N'Cấp 4')
GO

INSERT INTO NHA VALUES
('C2001',N'142 Lê Trọng Tấn,Tân Phú, TP.HCM',10000000,'NC2'),
('C3001',N'111 Bình Thới, Q11, TP.HCM',7000000,'NC3'),
('C4001',N'123 Tân Thới Nhất, Quận 12, TP.HCM',4000000,'NC4'),
('C4002',N'21 Tô Ký, Quận 12, TP.HCM',3500000,'NC4')
GO

INSERT INTO KHACHHANG VALUES
('KH001',N'Trần Thanh Bình',N'123, Trương Định, Q3, TP.HCM','0989123456',10000000),
('KH002',N'Trần Thị Lan',N'01, Lê Lai, Q1, TP.HCM','0918456234',9000000),
('KH003',N'Lê Thành Nam',N'12,Ngô Quyền, Q5, TP.HCM','0909657456',11000000),
('KH004',N'Nguyễn Thảo My',N'120, Thành Thái, Q10, TP.HCM','0912657489',3000000),
('KH005',N'Lê Anh Tuấn',N'123, Trương Định, TP.HCM','0989768567',4000000)
GO

INSERT INTO DANGTIN VALUES
('C2001','05/01/2016',7),
('C4001','05/02/2016',10),
('C4001','06/04/2016',30),
('C4001','06/13/2016',7),
('C3001','06/12/2016',7)

INSERT INTO XEMNHA (MANHA,MAKH,NGXEMNHA) VALUES
('C2001','KH003','05/07/2016'),
('C4002','KH002','05/07/2016'),
('C4001','KH004','06/05/2016'),
('C4001','KH002','06/14/2016'),
('C3001','KH001','06/15/2016')