CREATE DATABASE QL_CHUNGCHI
ON
(NAME = 'QL_CHUNGCHI',
FILENAME = 'F:\CSDL\SQL_DATA\QL_CHUNGCHI.mdf',
SIZE = 10MB,
MAXSIZE = UNLIMITED,
FILEGROWTH = 5MB)
LOG ON
(NAME = 'QL_CHUNGCHI_LOG',
FILENAME = 'F:\CSDL\SQL_DATA\QL_CHUNGCHI_LOG.ldf',
SIZE = 5MB,
MAXSIZE = UNLIMITED,
FILEGROWTH = 2MB)

USE QL_CHUNGCHI
GO

CREATE TABLE LOAICC
(MALCC CHAR(3) CONSTRAINT PK_LOAICC PRIMARY KEY,
TENLCC NVARCHAR(100))
GO

CREATE TABLE CHUNGCHI
(MACC CHAR(4) CONSTRAINT PK_CHUNGCHI PRIMARY KEY,
TENCC NVARCHAR(100),
THOIGIANHOC INT,
MALCC CHAR(3),
CONSTRAINT FK_CC FOREIGN KEY(MALCC) REFERENCES LOAICC(MALCC))
GO

CREATE TABLE HOCVIEN
(MAHV CHAR(5) CONSTRAINT PK_HV PRIMARY KEY,
HOTEN NVARCHAR(100),
NGSINH DATE CONSTRAINT CHK_NGSINH CHECK(YEAR(GETDATE())-YEAR(NGSINH)>=15),
GIOITINH NVARCHAR(5) CONSTRAINT CHK_GT CHECK(GIOITINH IN (N'Nam',N'Nữ',N'Khác')),
DIACHI NVARCHAR(100))
GO

CREATE TABLE LOPHOC
(MALH CHAR(6) CONSTRAINT PK_LH PRIMARY KEY,
TENLH NVARCHAR(100),
NGAYBD DATE,
NGAYKT DATE,
MACC CHAR(4),
HOCPHI INT DEFAULT(0),
CONSTRAINT FK_LH FOREIGN KEY(MACC) REFERENCES CHUNGCHI(MACC))
GO

CREATE TABLE DANGKY
(MAHV CHAR(5) NOT NULL,
MALH CHAR(6) NOT NULL,
CONSTRAINT PK_DK PRIMARY KEY(MAHV,MALH),
NGAYDK DATE,
TIENDATCOC INT DEFAULT(0),
TIENCONLAI INT DEFAULT(0),
CONSTRAINT FK_DANGKY_HV FOREIGN KEY(MAHV) REFERENCES HOCVIEN(MAHV),
CONSTRAINT FK_DANGKY_LH FOREIGN KEY(MALH) REFERENCES LOPHOC(MALH))
GO

INSERT INTO LOAICC VALUES
('CCA',N'Chứng chỉ A'),
('CCB',N'Chứng chỉ B'),
('CAD',N'Chứng chỉ AutoCad')
GO

INSERT INTO CHUNGCHI VALUES
('CCA1',N'Chứng chỉ A hạng 1',5,'CCA'),
('CCA2',N'Chứng chỉ A hạng 2',6,'CCA'),
('CCB1',N'Chứng chỉ B hạng 1',6,'CCB'),
('CCB2',N'Chứng chỉ B hạng 2',8,'CCB'),
('CAD1',N'Chứng chỉ AutoCad',9,'CAD')

INSERT INTO HOCVIEN VALUES
('HV001',N'Trần Thanh Bình','12/04/1998',N'Nữ',N'123,Trương Định,Q3,TP.HCM'),
('HV002',N'Trần Thị Lan','01/12/1997',N'Nữ',N'1,Paster,Q3,TP.HCM'),
('HV003',N'Lê Thành Nam','06/23/1999',N'Nam',N'12,Ngô Quyền,Q5,TP.HCM'),
('HV004',N'Nguyễn Thảo Mi','02/12/1987',N'Nữ',N'120,Thành Thái,Q10,TP.HCM')
GO

INSERT INTO LOPHOC VALUES
('CCA101','Chứng chỉ A 2,4,6','04/25/2016','05/30/2016','CCA1',500000),
('CCA202','Chứng chỉ A 3,5,7','04/26/2016','06/15/2016','CCA2',600000),
('CCB101','Chứng chỉ B 2,4,6','07/07/2016','08/20/2016','CCB1',650000),
('CCB201','Chứng chỉ B 3,5,7','07/08/2016','09/10/2016','CCB2',700000)
GO

INSERT INTO DANGKY VALUES
('HV001','CCA101','04/24/2016',500000,0),
('HV002','CCA202','04/26/2016',600000,0),
('HV003','CCB101','07/07/2016',500000,150000),
('HV004','CCB201','07/08/2016',500000,200000)
GO